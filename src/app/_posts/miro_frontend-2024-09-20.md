# 微前端框架

## 背景

考虑下面问题：
- 在开发一个大系统的时候，每个模块可能有不同的团队在开发，大家用的技术栈也可能不相同，如何将所有子模块整合到一个系统里，需要考虑。
- 大系统中，多个模块更新时间不一致，如何解决？
- 当一个系统有小变大时，想使用新的技术，同时又不想重写老的系统，或者没有资源重新老的系统，要怎么办？

## 什么是微前端

微前端是一种多个团队通过独立发布功能的方式来共同构建现代化 web 应用的技术手段及方法策略。

## 微前端特点

- 技术栈无关。主系统框架不限制接入应用的技术栈，微应用具备完全自主权
- 开发独立，部署独立。每个微应用都可以作为独立的应用提供服务
- 增量升级。当在老的系统中想使用新技术时，可以通过微应用的方式做增量升级，而不用动老的系统
- 应用隔离。每个微应用状态相互隔离，运行时状态互不影响

## 微前端实现方式

### 微前端iframe

微前端的实现方式最容易想到的就是iframe。

#### 优点

- iframe 提供了完美的沙箱机制，不论是样式隔离、js 隔离这类问题统统都能被完美解决。

#### 缺点

- url 不同步。浏览器刷新iframe url状态丢失，后退前进按钮无法使用。
- UI 不同步，DOM 结构不共享。比如在iframe 中弹出一个对话框，它的位置是相对于iframe的，无法在当前应用中居中。
- 父子应用上下文隔离，内存变量不共享。父子通讯、数据同步、免登陆都需要解决。
- 加载速度慢。

### 微前端动态加载

通过动态加载子应用的内容，动态渲染在主应用的元素中。

#### 优点

- UI 同步，DOM结构共享，可以解决子应用弹出窗口的问题
- url 同步，浏览器刷新后子应用状态不丢失，前进、后退功能完整
- 父子应用上下文共享，通讯方便，数据同步、免登录都容易实现

#### 缺点

- 上下文可能被修改，需要提供沙箱解决方案
- CSS 覆盖，需要提供样式隔离方案
- 父子应用使用同技术栈的情况下，资源重复加载

## TBC
